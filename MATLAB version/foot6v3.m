function y=foot6v3(x,p)

% 1=p, 2=R, 3=Q1, 4=Q2, 5=Q3, 6=q.
y=[x(1)*(x(4)+x(5)+x(2)) - p(1) + x(3)*x(6);
    x(1)*(1-x(1))*(x(5)+x(2)) - p(2) + x(3)*x(6)*(1-x(6)) + x(4)*x(6)*(1-x(1));
    x(1)*((1-x(1))^2)*x(2) - p(3) + (x(3)*x(6)*(1-x(6)) + x(4)*x(6)*(1-x(1)))*(1-x(6)) + x(5)*x(6)*((1-x(1))^2);
    x(1)*((1-x(1))^3)*x(2) - p(4) + ((x(3)*x(6)*(1-x(6)) + x(4)*x(6)*(1-x(1)))*(1-x(6)) + x(5)*x(6)*((1-x(1))^2))*(1-x(6));
    x(1)*((1-x(1))^4)*x(2) - p(5) + x(3)*x(1)*((1-x(6))^4) + x(4)*(1-x(1))*x(6)*((1-x(6))^3) + x(5)*x(6)*((1-x(6))^2)*((1-x(1))^2);
    x(3)+x(4)+x(5)+x(2)-1 ];